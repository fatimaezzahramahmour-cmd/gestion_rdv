{% load static %}
<!doctype html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}Cabinet Dentaire{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="{% static 'rdv/css/theme.css' %}" rel="stylesheet">
    <style>
      /* Header espace patient — centré, avec image, différent de la page d'accueil */
      .navbar-user { background: #fff !important; box-shadow: 0 2px 12px rgba(0,0,0,.06); }
      .navbar-user .navbar-inner { display: flex; flex-direction: column; align-items: center; width: 100%; text-align: center; }
      .navbar-user .header-brand { display: flex; flex-direction: column; align-items: center; gap: 0.5rem; margin-bottom: 0.75rem; text-decoration: none; color: inherit; }
      .navbar-user .header-logo { width: 72px; height: 72px; object-fit: cover; border-radius: 50%; border: 3px solid var(--dental-green); }
      .navbar-user .header-title { font-size: 1.1rem; font-weight: 700; color: var(--dental-green); margin: 0; }
      .navbar-user .header-sub { font-size: 0.75rem; font-weight: 600; text-transform: uppercase; letter-spacing: .05em; color: #5a6c7d; margin: 0; }
      .navbar-user .nav-links-wrap { display: flex; flex-wrap: wrap; justify-content: center; gap: 0.25rem; align-items: center; }
      .navbar-user .nav-link { color: var(--dental-green) !important; font-weight: 600; font-size: 0.9rem; padding: 0.5rem 0.75rem; border-radius: 6px; }
      .navbar-user .nav-link:hover { color: var(--dental-green-dark) !important; background: rgba(26, 127, 55, 0.08); }
      .navbar-user .nav-link.btn-dental { color: #fff !important; }
      .navbar-user .navbar-toggler { position: absolute; right: 1rem; top: 1.25rem; }
      @media (min-width: 992px) { .navbar-user .navbar-toggler { display: none; } }
      @media (max-width: 991px) { .navbar-user .navbar-inner { padding-top: 2rem; } }
      .espace-patient .page-title { color: var(--dental-green); font-weight: 700; margin-bottom: 0; }
      .espace-patient .btn-primary-custom { background: var(--dental-green); border-color: var(--dental-green); }
      .espace-patient .btn-primary-custom:hover { background: var(--dental-green-dark); border-color: var(--dental-green-dark); }
      .espace-patient .btn-success-custom { background: var(--dental-green); border-color: var(--dental-green); }
      .espace-patient .btn-success-custom:hover { background: var(--dental-green-dark); border-color: var(--dental-green-dark); }
      .espace-patient .rdv-item-title { color: var(--dental-green-dark); }
      .espace-patient .card-custom { border-left: 4px solid var(--dental-green); }
      .espace-client-banner {
        width: 100%;
        aspect-ratio: 21 / 9;
        min-height: 280px;
        max-height: 420px;
        background-color: #e8f5e9;
        background-image: linear-gradient(90deg, rgba(26,127,55,.06) 0%, transparent 35%), url('https://images.unsplash.com/photo-1629909613654-28e377c37b09?w=1600&q=85');
        background-size: cover;
        background-position: center center;
        background-repeat: no-repeat;
        border-radius: 0 0 20px 20px;
        margin: -1rem 0 1.5rem;
        overflow: hidden;
      }
      .espace-patient .main-wrap { background: #fff; border-radius: 16px; box-shadow: 0 4px 24px rgba(0,0,0,.06); padding: 1.5rem; margin-bottom: 2rem; }
      .espace-patient .client-visual-wrap { flex-shrink: 0; width: 100%; max-width: 520px; border-radius: 14px; overflow: hidden; box-shadow: 0 8px 24px rgba(26,127,55,.15); border: 1px solid rgba(26,127,55,.2); }
      .espace-patient .client-visual { display: block; width: 100%; height: 300px; object-fit: cover; object-position: center; background: #e8f5e9; }
      .espace-receptionniste .espace-client-banner {
        background-image: linear-gradient(90deg, rgba(26,127,55,.06) 0%, transparent 35%), url('https://images.unsplash.com/photo-1579684385127-1ef15d508118?w=1920&q=90');
        background-size: cover;
        background-position: center center;
      }
    </style>
  </head>
  <body class="espace-patient {% if request.user.is_authenticated and request.user.profile.role == 'agent' %}espace-receptionniste{% endif %}">
    <nav class="navbar navbar-expand-lg navbar-light navbar-user py-4 mb-4 position-relative">
      <div class="container">
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navApp" aria-controls="navApp" aria-expanded="false" aria-label="Menu">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navApp">
          <div class="navbar-inner">
            <a class="header-brand" href="{% url 'accueil' %}">
              <img src="https://i.pinimg.com/736x/9c/87/99/9c879909741ebaa6b7a614071079e542.jpg" alt="Cabinet dentaire" class="header-logo">
              <span class="header-sub">Centre Dentaire</span>
              {% if request.user.is_authenticated and request.user.profile.role == 'agent' %}
                <span class="header-title">Espace réceptionniste</span>
              {% else %}
                <span class="header-title">Espace client</span>
              {% endif %}
            </a>
            <div class="nav-links-wrap">
              {% if request.user.is_authenticated and request.user.profile.role == 'agent' %}
                <a class="nav-link" href="{% url 'agent_dashboard' %}">Tableau de bord</a>
                <a class="nav-link" href="{% url 'agent_file_attente' %}">File d'attente</a>
                <a class="nav-link btn btn-dental" href="{% url 'logout' %}">Déconnexion</a>
              {% elif request.user.is_authenticated %}
                <a class="nav-link" href="{% url 'rdv_list' %}">Mes rendez-vous</a>
                <a class="nav-link" href="{% url 'file_attente' %}">File d'attente</a>
                <a class="nav-link" href="{% url 'rdv_create' %}">Nouveau</a>
                <a class="nav-link btn btn-dental" href="{% url 'logout' %}">Déconnexion</a>
              {% else %}
                <a class="nav-link" href="{% url 'login' %}">Se connecter</a>
                <a class="nav-link btn btn-dental" href="{% url 'signup' %}">RDV +</a>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    </nav>

    <div class="container py-3">
      <div class="espace-client-banner"></div>
      <div class="main-wrap">
        <div class="d-flex align-items-center gap-4 mb-4 flex-wrap">
          <div class="client-visual-wrap">
            {% if request.user.is_authenticated and request.user.profile.role == 'agent' %}
              <img src="https://images.unsplash.com/photo-1588776814546-1ffcf47267a5?w=1000&q=85" alt="Réception — Cabinet dentaire" class="client-visual" width="520" height="300" loading="eager">
            {% else %}
              <img src="https://images.unsplash.com/photo-1606811841689-23dfddce3e95?w=1000&q=85" alt="Cabinet dentaire" class="client-visual" width="520" height="300" loading="eager">
            {% endif %}
          </div>
          <div class="flex-grow-1">
            {% if request.user.is_authenticated and request.user.profile.role == 'agent' %}
              <h2 class="h5 mb-1" style="color: var(--dental-green);">Espace réceptionniste</h2>
              <p class="text-muted small mb-0">Gérer la file d'attente, confirmer la présence des patients, donner la priorité aux cas urgents.</p>
            {% else %}
              <h2 class="h5 mb-1" style="color: var(--dental-green);">Votre espace</h2>
              <p class="text-muted small mb-0">Gérez vos rendez-vous et consultez la file d'attente.</p>
            {% endif %}
          </div>
        </div>
        {% block content %}{% endblock %}
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
